<!DOCTYPE html>


<html lang="zh-CN" >


<head>
  <meta charset="utf-8" />
    
  <meta name="description" content="Tech,Idea,Funny,Daily" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     Riven的博客
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  <link rel="stylesheet" href="/dist/main.css">
  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  

</head>

</html>

<body>
  <div id="app">
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/rivenZoo"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover8.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">Riven的博客</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>

<div id="main">
  <section class="outer">
  <article class="articles">
    
    
    
    
    <article id="post-shell基础语法" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2018/09/02/shell基础语法/"
    >shell基础语法</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2018/09/02/shell基础语法/" class="article-date">
  <time datetime="2018-09-01T16:54:35.000Z" itemprop="datePublished">2018-09-02</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/编程语言/">编程语言</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="shell基础语法"><a href="#shell基础语法" class="headerlink" title="shell基础语法"></a>shell基础语法</h3><h4 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h4><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ expression ][</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   Statement(s) <span class="keyword">to</span> be executed <span class="keyword">if</span> expression <span class="keyword">is</span> <span class="literal">true</span></span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> test expression; <span class="keyword">then</span></span><br><span class="line">   Statement(s) <span class="keyword">to</span> be executed <span class="keyword">if</span> expression <span class="keyword">is</span> <span class="literal">true</span></span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ expression <span class="number">1</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   Statement(s) <span class="keyword">to</span> be executed <span class="keyword">if</span> expression <span class="number">1</span> <span class="keyword">is</span> <span class="literal">true</span></span><br><span class="line">elif [[ expression <span class="number">2</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   Statement(s) <span class="keyword">to</span> be executed <span class="keyword">if</span> expression <span class="number">2</span> <span class="keyword">is</span> <span class="literal">true</span></span><br><span class="line">elif [[ expression <span class="number">3</span> ]]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">   Statement(s) <span class="keyword">to</span> be executed <span class="keyword">if</span> expression <span class="number">3</span> <span class="keyword">is</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">   Statement(s) <span class="keyword">to</span> be executed <span class="keyword">if</span> <span class="literal">no</span> expression <span class="keyword">is</span> <span class="literal">true</span></span><br><span class="line">fi</span><br></pre></td></tr></table></figure>


<h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SERVICES=<span class="string">"80   22   25   110   8000   23   20   21   3306   "</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="variable">$SERVICES</span>; do</span><br><span class="line">  iptables -A INPUT -p tcp --dport <span class="variable">$x</span> -m <span class="keyword">state</span> --state NEW -j ACCEPT</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 以下是Bash的用法，与zsh的不同</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> a=(1 2 3 4 5)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$a</span></span></span><br><span class="line">1</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$&#123;#a[@]&#125;</span> <span class="comment"># 用$&#123;#数组名[@或*]&#125; 可以得到数组长度</span></span></span><br><span class="line">5</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$&#123;a[*]&#125;</span> <span class="comment"># 用$&#123;数组名[下标]&#125; 下标是从0开始  下标是：*或者@ 得到整个数组内容</span></span></span><br><span class="line">1 2 3 4 5</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 直接通过 数组名[下标] 就可以对其进行引用赋值，如果下标不存在，自动添加新一个数组元素到数组末尾</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> a[1]=100 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;a[1]&#125;</span></span></span><br><span class="line">100</span><br><span class="line"><span class="meta">#</span><span class="bash"> a[10]=100 &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;a[*]&#125;</span> &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;a[10]&#125;</span> &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;#a[*]&#125;</span></span></span><br><span class="line">1 2 3 4 5 100</span><br><span class="line">100</span><br><span class="line">6</span><br><span class="line">	</span><br><span class="line"><span class="meta">#</span><span class="bash"> 直接通过：<span class="built_in">unset</span> 数组[下标] 可以清除相应的元素，不带下标，清除整个数据。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">unset</span> a[1] &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;#a[*]&#125;</span> &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;a[1]&#125;</span> &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;a[*]&#125;</span></span></span><br><span class="line">5</span><br><span class="line"></span><br><span class="line">1 3 4 5 100</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 直接通过 <span class="variable">$&#123;数组名[@或*]:起始位置:长度&#125;</span> 切片原先数组，返回是字符串，中间用“空格”分开，因此如果加上”()”，将得到切片数组，上面例子：c 就是一个新数据。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> a=(1 2 3 4 5) &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;a[@]:0:3&#125;</span></span></span><br><span class="line">1 2 3</span><br><span class="line"><span class="meta">#</span><span class="bash"> c=(<span class="variable">$&#123;a[@]:1:4&#125;</span>) &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;#c[@]&#125;</span></span></span><br><span class="line">4</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 替换元素调用方法是：<span class="variable">$&#123;数组名[@或*]/查找字符/替换字符&#125;</span> 该操作不会改变原先数组内容，如果需要修改，可以看上面例子，重新定义数据。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> a=(1 2 3 4 5) &amp;&amp; c=(<span class="variable">$&#123;a[@]/3/100&#125;</span>) &amp;&amp; <span class="built_in">echo</span> <span class="variable">$&#123;c[@]&#125;</span></span></span><br><span class="line">1 2 100 4 5</span><br><span class="line">	</span><br><span class="line"><span class="meta">#</span><span class="bash"> 判断元素是否在数组中</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="keyword">if</span> [[ <span class="variable">$&#123;array[@]&#125;</span> =~ <span class="variable">$item</span> ]]; <span class="keyword">then</span> <span class="built_in">echo</span> <span class="string">'yes'</span>; <span class="keyword">fi</span></span></span><br></pre></td></tr></table></figure>

<h4 id="命令行解析"><a href="#命令行解析" class="headerlink" title="命令行解析"></a>命令行解析</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># use <span class="keyword">break</span> to jump <span class="keyword">out</span> <span class="keyword">for</span> loop</span><br><span class="line"><span class="keyword">for</span> opt <span class="keyword">in</span> $@; <span class="keyword">do</span></span><br><span class="line">case $opt <span class="keyword">in</span></span><br><span class="line">	<span class="keyword">init</span>) project_init</span><br><span class="line">	<span class="keyword">break</span>;;</span><br><span class="line">	start) start_train</span><br><span class="line">	<span class="keyword">break</span>;;</span><br><span class="line">	stop) stop_train</span><br><span class="line">	<span class="keyword">break</span>;;</span><br><span class="line">	resume) resume_train</span><br><span class="line">	<span class="keyword">break</span>;;</span><br><span class="line">	*) show_usage</span><br><span class="line">	<span class="keyword">break</span>;;</span><br><span class="line">esac</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<h4 id="函数返回值"><a href="#函数返回值" class="headerlink" title="函数返回值"></a>函数返回值</h4><ul>
<li><p>通过子命令的方式</p>
<p>  函数内部任何标准输出都会返回给接收变量，结果容易受到输出日志的干扰</p>
  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> </span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line">a=$(foo)</span><br><span class="line"><span class="keyword">echo</span> $a <span class="comment"># 1 2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过return返回整数值，<code>$?</code>获取</p>
  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span> </span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="number">2</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">foo <span class="comment"># 1 2</span></span><br><span class="line"><span class="keyword">echo</span> $? <span class="comment"># 0</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h4><ul>
<li>截取字符串</li>
</ul>
<table>
<thead>
<tr>
<th>表达式</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>$&#123;#string}</td>
<td>$string的长度</td>
</tr>
<tr>
<td><code>${string:position}</code></td>
<td>在$string中, 从位置$position开始提取子串</td>
</tr>
<tr>
<td><code>${string:position:length}</code></td>
<td>在$string中, 从位置$position开始提取长度为$length的子串</td>
</tr>
<tr>
<td><code>${string#substring}</code></td>
<td>从变量$string的开头, 删除最短匹配$substring的子串</td>
</tr>
<tr>
<td><code>${string##substring}</code></td>
<td>从变量$string的开头, 删除最长匹配$substring的子串</td>
</tr>
<tr>
<td><code>${string%substring}</code></td>
<td>从变量$string的结尾, 删除最短匹配$substring的子串</td>
</tr>
<tr>
<td><code>${string%%substring}</code></td>
<td>从变量$string的结尾, 删除最长匹配$substring的子串</td>
</tr>
<tr>
<td><code>${string/substring/replacement}</code></td>
<td>使用$replacement, 来代替第一个匹配的$substring</td>
</tr>
<tr>
<td><code>${string//substring/replacement}</code></td>
<td>使用$replacement, 代替所有匹配的$substring</td>
</tr>
<tr>
<td><code>${string/#substring/replacement}</code></td>
<td>如果$string的前缀匹配$substring, 那么就用$replacement来代替匹配到的$substring</td>
</tr>
<tr>
<td><code>${string/%substring/replacement}</code></td>
<td>如果$string的后缀匹配$substring, 那么就用$replacement来代替匹配到的$substring</td>
</tr>
</tbody></table>
<ul>
<li><p>示例:</p>
<pre><code>${str:0:-1} 去掉最后一个字符
${str:0: ${#str}} 返回整个字符串。避免写成$#str，$#有特殊含义，是传给函数或脚本的参数个数
``` </code></pre></li>
<li><p>定义字符串</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>表达式</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>${var}</code></td>
<td>变量var的值, 与$var相同</td>
</tr>
<tr>
<td><code>${var-DEFAULT}</code></td>
<td>如果var没有被声明, 那么就以$DEFAULT作为其值，但是不会改变变量的值 *</td>
</tr>
<tr>
<td><code>${var:-DEFAULT}</code></td>
<td>如果var没有被声明, 或者其值为空, 那么就以$DEFAULT作为其值 *</td>
</tr>
<tr>
<td><code>${var=DEFAULT}</code></td>
<td>如果var没有被声明, 那么就以$DEFAULT作为其值，跟上面<code>-</code>的区别在于会设置变量的值 *</td>
</tr>
<tr>
<td><code>${var:=DEFAULT}</code></td>
<td>如果var没有被声明, 或者其值为空, 那么就以$DEFAULT作为其值 *</td>
</tr>
<tr>
<td><code>${var+OTHER}</code></td>
<td>如果var声明了, 那么其值就是$OTHER, 否则就为null字符串</td>
</tr>
<tr>
<td><code>${var:+OTHER}</code></td>
<td>如果var被设置了, 那么其值就是$OTHER, 否则就为null字符串</td>
</tr>
<tr>
<td><code>${var?ERR_MSG}</code></td>
<td>如果var没被声明, 那么就打印$ERR_MSG *</td>
</tr>
<tr>
<td><code>${var:?ERR_MSG}</code></td>
<td>如果var没被设置, 那么就打印$ERR_MSG *</td>
</tr>
<tr>
<td><code>${!varprefix*}</code></td>
<td>匹配之前所有以varprefix开头进行声明的变量</td>
</tr>
<tr>
<td><code>${!varprefix@}</code></td>
<td>匹配之前所有以varprefix开头进行声明的变量</td>
</tr>
</tbody></table>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Shell/">Shell</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-Git-Hooks" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2018/09/02/Git-Hooks/"
    >Git Hooks</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2018/09/02/Git-Hooks/" class="article-date">
  <time datetime="2018-09-01T16:48:50.000Z" itemprop="datePublished">2018-09-02</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/git/">git</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h2 id="Git-Hooks"><a href="#Git-Hooks" class="headerlink" title="Git Hooks"></a>Git Hooks</h2><p>git通过hooks来定制行为，所有的hooks存储在<code>hooks</code>目录，客户端是<code>.git/hooks</code>目录。<br><code>git init</code>的时候会在<code>.git/hooks</code>目录生成很多示例hook，只要重命名文件就能启用。</p>
<p>hook分为</p>
<ul>
<li>客户端hook</li>
<li>服务端hook</li>
</ul>
<p>客户端hook不会被克隆，如果要强制实现某个git策略，需要用服务端hook。</p>
<h3 id="客户端hook"><a href="#客户端hook" class="headerlink" title="客户端hook"></a>客户端hook</h3><p>客户端hook在工程目录下运行<br>客户端hook又可以分为</p>
<ul>
<li>committing-workflow</li>
<li>email-workflow</li>
<li>其他</li>
</ul>
<h4 id="committing-workflow"><a href="#committing-workflow" class="headerlink" title="committing-workflow"></a>committing-workflow</h4><ul>
<li><p>pre-commit</p>
<p>  第一个运行的hook，在创建提交message之前就运行。<br>  返回非0则终止提交，但是可以用<code>git commit --no-verify</code>来跳过检查。<br>  可以在这个hook中运行测试，检查代码格式，做代码静态检查等。</p>
</li>
<li><p>prepare-commit-msg</p>
<p>  在默认commit message创建之后，打开message编辑器之前运行。<br>  会传入几个参数：当前消息文件路径、commit类型，如果是amend提交再加上commit的SHA-1。<br>  一般用来生成自动提交的信息。</p>
</li>
<li><p>commit-msg</p>
<p>  编辑完提交消息之后运行。<br>  传入一个参数：保存用户提交消息的临时文件的路径。<br>  返回非0终止提交。<br>  一般用来验证消息格式。</p>
</li>
<li><p>post-commit    </p>
<p>  提交完成之后运行。<br>  一般用来做提交通知。</p>
</li>
</ul>
<h4 id="email-workflow-hooks"><a href="#email-workflow-hooks" class="headerlink" title="email-workflow hooks"></a>email-workflow hooks</h4><p>通过<code>git am</code>命令调用，如果你需要通过email来接收patch，可能会用到这个类型的hook。</p>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><ul>
<li><p>pre-rebase</p>
<p>  rebase之前运行。<br>  返回非0终止rebase。</p>
</li>
<li><p>post-rewrite</p>
<p>  <code>git commit --amend</code>和<code>git rebase</code>会触发这个hook。<br>  传入参数：触发hook的命令。</p>
</li>
<li><p>post-checkout</p>
<p>  checkout成功之后运行。</p>
</li>
<li><p>post-merge</p>
<p>  merge成功之后运行。</p>
</li>
<li><p>pre-push</p>
<p>  remote ref更新之后，传输对象之前运行。<br>  返回非0终止push。<br>  传入参数：远端的名称和地址。</p>
</li>
<li><p>pre-auto-gc</p>
<p>  由<code>git gc --auto</code>触发。</p>
</li>
</ul>
<h3 id="服务端hook"><a href="#服务端hook" class="headerlink" title="服务端hook"></a>服务端hook</h3><p>服务端hook在服务器的工程<code>.git</code>目录下运行</p>
<ul>
<li><p>pre-receive</p>
<p>  服务端接收push第一个运行的hook，从stdin接收被push过来的references。<br>  返回非0则终止push。</p>
</li>
<li><p>update</p>
<p>  类似pre-receive，但是每个分支运行一次。<br>  传入三个参数：分支名、前一个commit的SHA-1，当前push的SHA-1<br>  返回非0则终止push。    </p>
</li>
<li><p>post-receive</p>
<p>  所有流程完成之后运行。<br>  跟pre-receive一样从stdin传入references。<br>  客户端等待这个脚本完成才断开连接。</p>
</li>
</ul>
<h3 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h3><p><a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks" target="_blank" rel="noopener">https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks</a><br><a href="https://docs.gitlab.com/ee/administration/custom_hooks.html" target="_blank" rel="noopener">https://docs.gitlab.com/ee/administration/custom_hooks.html</a></p>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git-hook/">git hook</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-Cpp-Static-initialization-order-fiasco" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2017/01/20/Cpp-Static-initialization-order-fiasco/"
    >Cpp Static Initialization Order Fiasco</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2017/01/20/Cpp-Static-initialization-order-fiasco/" class="article-date">
  <time datetime="2017-01-20T12:08:13.000Z" itemprop="datePublished">2017-01-20</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/编程语言/">编程语言</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="Static-initialization-order-fiasco"><a href="#Static-initialization-order-fiasco" class="headerlink" title="Static initialization order fiasco"></a>Static initialization order fiasco</h3><ul>
<li><p>Construct On First Use Idiom</p>
<ul>
<li><p>If the object does not need to be destructed, uses a static pointer.</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// File x.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Fred.h"</span></span></span><br><span class="line"><span class="function">Fred&amp; <span class="title">x</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> Fred* ans = <span class="keyword">new</span> Fred();</span><br><span class="line">  <span class="keyword">return</span> *ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// File Barney.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"Barney.h"</span></span></span><br><span class="line"><span class="symbol">Barney:</span>:Barney()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  x().goBowling();</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This approach is that the Fred object is <strong>never destructed</strong>.<br>The Construct On First Use Idiom uses a pointer and intentionally leaks the object.</p>
</li>
<li><p>If you need to destruct the object and do not care the order of static objects deinitialization, uses a static object.</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// File x.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Fred.h"</span></span></span><br><span class="line"><span class="function">Fred&amp; <span class="title">x</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">static</span> Fred ans;  <span class="comment">// was static Fred* ans = new Fred();</span></span><br><span class="line">  <span class="keyword">return</span> ans;       <span class="comment">// was return *ans;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  It does not leak the object, but <strong>it does not control the order of static deinitialization</strong>, so it is (very!) unsafe to use the object during static deinitialization, that is, from a destructor of another statically declared object.</p>
</li>
</ul>
</li>
<li><p>Nifty Counter</p>
<p>  It is a more complicated solution that solves problems mentioned above.</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Stream.h</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> STREAM_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> STREAM_H</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Stream</span> &#123;</span></span><br><span class="line">  Stream ();</span><br><span class="line">  ~Stream ();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">extern</span> Stream&amp; stream; <span class="comment">// global stream object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">StreamInitializer</span> &#123;</span></span><br><span class="line">  StreamInitializer ();</span><br><span class="line">  ~StreamInitializer ();</span><br><span class="line">&#125; streamInitializer; <span class="comment">// static initializer for every translation unit</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// STREAM_H</span></span></span><br></pre></td></tr></table></figure>

  <figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Stream.cpp</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"Stream.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;new&gt;         // placement new</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;type_traits&gt; // aligned_storage</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> nifty_counter; <span class="comment">// zero initialized at load time</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">typename</span> std::aligned_storage&lt;<span class="keyword">sizeof</span> (<span class="built_in">Stream</span>), <span class="keyword">alignof</span> (<span class="built_in">Stream</span>)&gt;::type</span><br><span class="line">  stream_buf; <span class="comment">// memory for the stream object</span></span><br><span class="line"><span class="built_in">Stream</span>&amp; stream = <span class="keyword">reinterpret_cast</span>&lt;<span class="built_in">Stream</span>&amp;&gt; (stream_buf);</span><br><span class="line"></span><br><span class="line"><span class="built_in">Stream</span>::<span class="built_in">Stream</span> ()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// initialize things</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Stream</span>::~<span class="built_in">Stream</span> ()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// clean-up</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">StreamInitializer::StreamInitializer ()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">if</span> (nifty_counter++ == <span class="number">0</span>) <span class="keyword">new</span> (&amp;stream) <span class="built_in">Stream</span> (); <span class="comment">// placement new</span></span><br><span class="line">&#125;</span><br><span class="line">StreamInitializer::~StreamInitializer ()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">if</span> (--nifty_counter == <span class="number">0</span>) (&amp;stream)-&gt;~<span class="built_in">Stream</span> ();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  The header file of the Stream class <strong>must be included before any member function can be called on the Stream object</strong>.<br>  An instance of the StreamInitializer class is included in each compilation unit. Any use of the Stream object follows the inclusion of the header, which ensures that the constructor of the initializer object is called before the Stream object is used.</p>
</li>
</ul>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C-C/">C/C++</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-go-doc-tips" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/12/18/go-doc-tips/"
    >go-doc-tips</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2016/12/18/go-doc-tips/" class="article-date">
  <time datetime="2016-12-18T13:57:03.000Z" itemprop="datePublished">2016-12-18</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/编程语言/">编程语言</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="Go-doc-tips"><a href="#Go-doc-tips" class="headerlink" title="Go doc tips"></a>Go doc tips</h3><ol>
<li><p>新建<code>doc.go</code>作为文档文件，<code>package pkgname</code>之前的注释作为文档。</p>
</li>
<li><p>文档注释的格式</p>
<ol>
<li>相邻的行位于同一段落，分段需要添加空行</li>
<li>上下空行的短语会被作为接下来段落的head</li>
<li>预先格式化的文本需要跟周围的注释保持缩进</li>
<li>URL会被转换成链接，不需要标记</li>
</ol>
</li>
<li><p>Go同一个目录可以添加<code>{pkg}_test</code>的测试包。</p>
</li>
<li><p>包<code>{pkg}_test</code>的文件(<code>_test.go</code>结尾)，函数名以<code>Example</code>开头且没有参数的函数作为示例代码。</p>
 <figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleFoo</span><span class="params">()</span></span>     <span class="comment">// documents the Foo function or type</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleBar_Qux</span><span class="params">()</span></span> <span class="comment">// documents the Qux method of type Bar</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Example</span><span class="params">()</span></span>        <span class="comment">// documents the package as a whole</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleReverse</span><span class="params">()</span></span> <span class="comment">// Reverse first example</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleReverse_second</span><span class="params">()</span></span> <span class="comment">// Reverse second example</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleReverse_third</span><span class="params">()</span></span> <span class="comment">// Reverse thirdß example</span></span><br></pre></td></tr></table></figure>

<p> <code>_test.go</code>结尾的文件，如果只包含一个<code>Example</code>函数，并且有其他包级声明，整个文件会作为示例代码显示。</p>
</li>
<li><p><code>// Output: olleh</code>预期输出，示例函数可以作为<code>go test</code>的测试用例。</p>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> stringutil_test</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">    <span class="string">"github.com/golang/example/stringutil"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleReverse</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(stringutil.Reverse(<span class="string">"hello"</span>))</span><br><span class="line">    <span class="comment">// Output: olleh</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Go/">Go</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
    <article id="post-vim-shortcut" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2016/12/12/vim-shortcut/"
    >vim-shortcut</a> 
</h2>
 

    </header>
    

    
    <div class="article-meta">
      <a href="/2016/12/12/vim-shortcut/" class="article-date">
  <time datetime="2016-12-12T12:17:08.000Z" itemprop="datePublished">2016-12-12</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/编程工具/">编程工具</a>
  </div>

      
      
      
    </div>
    

    

    
    <div class="article-entry" itemprop="articleBody">
      
      

      
      <h3 id="vim快捷键"><a href="#vim快捷键" class="headerlink" title="vim快捷键"></a>vim快捷键</h3><h4 id="跳转"><a href="#跳转" class="headerlink" title="跳转"></a>跳转</h4><ol>
<li><p>行内跳转 </p>
<p> <code>^</code> 行开头<br> <code>$</code> 行尾<br> <code>w/W</code> 下一个单词开头<br> <code>e/E</code> 下一个单词末尾<br> <code>b/B</code> 上一个单词开头<br> <code>f+{字符}</code> 下一个字符本身 <code>F+{字符}</code> 上一个字符本身<br> <code>t+{字符}</code> 下一个字符之后 <code>T+{字符}</code> 上一个字符之后</p>
</li>
</ol>
<ol start="2">
<li><p>跨行跳转</p>
<p> <code>h</code> 左 <code>j</code> 下 <code>k</code> 上 <code>l</code> 右<br> <code>{数字}+h/j/k/l</code> 跳转n个位置<br> <code>{数字}+G</code> 跳转到第n行<br> <code>*</code> 向下搜索光标对应单词<br> <code>#</code> 向上搜索光标对应单词<br> <code>gg</code> 文件开头<br> <code>G</code> 文件末尾<br> <code>ctrl+b</code> 向上翻页<br> <code>ctrl+f</code> 向下翻页<br> <code>ctrl+u</code> 向上翻半页<br> <code>ctrl+d</code> 向下翻半页<br> <code>ctrl+o</code> 跳转到光标上一个位置<br> <code>ctrl+i</code> 跳转到光标下一个位置</p>
</li>
</ol>
<h4 id="编辑"><a href="#编辑" class="headerlink" title="编辑"></a>编辑</h4><ol>
<li><p>行内编辑</p>
<p> <code>x</code> 删除一个字符<br> <code>{数字}+x</code> 删除n个字符<br> <code>dd</code> 删除一行，包括换行<br> <code>d+{数字}+d</code> / <code>{数字}+dd</code> 删除n行<br> <code>d+w/W</code> / <code>d+e/E</code> 向后删除一个单词<br> <code>d+b/B</code> 向前删除一个单词<br> <code>D</code> / <code>d+$</code> 删除光标之后所有字符，不包括换行<br> <code>i</code> 光标之前插入<br> <code>a</code> 光标之后插入<br> <code>r</code> 替换光标处字符<br> <code>{数字}+r</code>    替换光标开始n个字符<br> <code>o</code> 插入下一行，光标跳转到新行<br> <code>O</code> 插入上一行，光标跳转到新行</p>
</li>
<li><p>复制粘贴</p>
<p> <code>yy</code> 复制一行<br> <code>{数字}+yy</code> / <code>y+{数字}+y</code> 复制n行<br> <code>y+{位置}+y</code> 复制光标与某一行直接的内容<br> <code>y+w/W</code> / <code>y+e/E</code> 向后复制一个单词<br> <code>y+b/B</code> 向前复制一个单词<br> <code>p</code> 在光标后粘贴<br> <code>P</code> 在光标前粘贴<br> <code>{数字}+p</code> 多次粘贴</p>
</li>
</ol>
<h4 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h4><ol>
<li><p>常规模式</p>
<p> <code>:h registers</code> 查看man page<br> <code>&quot;+{寄存器名}</code> 引用一个寄存器<br> <code>&quot;&quot;</code> 未命名寄存器，复制或删除都会替换它的内容<br> <code>&quot;0~&quot;9</code> <code>&quot;0</code> 保存最后一次复制内容 <code>&quot;1</code>~<code>&quot;9</code> 保存最后删除的内容，<code>&quot;1</code>为最近删除<br> <code>&quot;+{寄存器名}+y</code> 复制到指定寄存器<br> <code>&quot;+{寄存器名}+p</code> 粘贴指定寄存器内容<br> <code>:reg {寄存器名}</code> 查看寄存器内容<br> <code>&quot;.</code> <code>&quot;%</code> <code>&quot;:</code> <code>&quot;#</code> 只读寄存器</p>
<blockquote>
</blockquote>
<p> <code>&quot;.</code>存最后插入的内容；<code>&quot;%</code>存当前文件相对于vim打开时的路径；<code>&quot;:</code>存最后执行的命令，使用<code>@:</code>重复执行上一次命令；<code>&quot;#</code>存替换文件名</p>
<p> <code>&quot;=</code>保存表达式或命令结果，<code>ctrl-r =</code>可以在插入模式下粘贴结果，<code>:%s/&lt;Ctrl-r&gt;/something/g</code>可以直接替换之前搜索的结果<br> <code>:let @{寄存器名}=&#39;&lt;Ctrl-r {寄存器名}&gt;&#39;</code> 可以修改寄存器内容</p>
</li>
<li><p>编辑模式 </p>
<p> <code>ctrl+r+{寄存器名}</code> 粘贴寄存器内容</p>
</li>
</ol>

      
      <!-- reward -->
      
    </div>
    
    
      <!-- copyright -->
      
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vim/">Vim</a></li></ul>


    </footer>

  </div>

  

  
  
  

  

</article>
    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2015-2020
        RivenZoo
      </li>
      <li>
        
        Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <span>
  <i>PV:<span id="busuanzi_value_page_pv"></span></i>
  <i>UV:<span id="busuanzi_value_site_uv"></span></i>
</span>
        
      </li>
      
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://v1.cnzz.com/z_stat.php?id=1278725971&amp;web_id=1278725971'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Riven的博客"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories/">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/lazyload.min.js"></script>

<script>
  try {
    var typed = new Typed("#subtitle", {
      strings: ['日々私たちが过ごしている日常は、実は、奇迹の连続なのかもしれな', '想要的都拥有，得不到的都释怀', '虽不能至，心向往之'],
      startDelay: 0,
      typeSpeed: 200,
      loop: true,
      backSpeed: 100,
      showCursor: true
    });
  } catch (err) {
  }

</script>





<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>
<script src="/dist/main.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>



<script src="/js/busuanzi-2.3.pure.min.js"></script>


<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>

    
  </div>
</body>

</html>